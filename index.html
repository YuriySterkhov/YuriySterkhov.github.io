<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
  <title>Страница о ковке</title>
  <script src="vendor/js/jquery-3.3.1.slim.min.js" defer></script>

    <script src="vendor/js/popper.min.js" async></script>

    <link rel="icon" type="image/x-icon" href="yus_small.ico"> <!-- Укажите правильный путь к вашему файлу favicon -->
    <link rel="stylesheet" href="vendor/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <script src="vendor/js/bootstrap.min.js" defer></script>
</head>
  
  <body>
    <header>
  <div class="collapse bg-dark" id="navbarHeader">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-md-7 py-4">
          <h4 class="text-white">Обо мне</h4>
          <br>
          <p class="text-muted">Здравствуйте!</p>
          <p class="text-muted">Меня зовут Юрий. На этой странице Вы найдёте краткую информацию о тех работах, которые уже завершены, о стоимости работ и о том, как можно со мной связаться.</p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Контакты</h4>
          <br>                
          <a href="mailto:y.sterhov@mail.ru" class="mail-icon" target="_blank" title="Напишите мне email">
              <i class="fas fa-envelope"></i>
          </a>
          <a href="https://telegram.me/Yuriy_S_v" class="telegram-icon" target="_blank" title="Напишите мне в Telegram">
               <i class="fab fa-telegram-plane"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container d-flex justify-content-between">
      <a href="#" class="navbar-brand d-flex align-items-center">
        <!-- <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2" focusable="false" aria-hidden="true"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> -->        
        <strong>Добро пожаловать!</strong>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </div>
</header>

<main role="main">

  

  <div class="album py-5 bg-light">
    <div class="container">            
        <p class="lead text-muted"  align="justify">Эта страница создана для удобства нашего взаимодействия, когда Вы захотите заказать кованое изделие. Ниже представлены фотографии изделий, находящихся в эксплуатации. </p>      
        <br>
        <!-- <p>
            <a href="#" class="btn btn-primary my-2">Main call to action</a>
            <a href="#" class="btn btn-secondary my-2">Secondary action</a>
        </p> -->
    </div>         
        
    <div class="container">
        

      <div class="row">
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="1.jpg" class="card-img-top" alt="1">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Ворота с калиткой и забор.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">View</button> -->
                  <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('1.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="2.jpg" class="card-img-top" alt="2">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Ворота и калитка. Ворота.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('2.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="3.jpg" class="card-img-top" alt="3">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Ворота и калитка. Калитка.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('3.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="4.jpg" class="card-img-top" alt="4">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Оградка.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('4.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="5.jpg" class="card-img-top" alt="5">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Калитка.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('5.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="6.jpg" class="card-img-top" alt="6">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Калитка.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('6.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="7.jpg" class="card-img-top" alt="7">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Скамейка.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('7.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="8.jpg" class="card-img-top" alt="8">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Парник.</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('8.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
            <img src="9.jpg" class="card-img-top" alt="9">
            <!-- <svg class="bd-placeholder-img card-img-top" width="100%" height="225" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img" aria-label="Placeholder: Thumbnail"><title>Placeholder</title><rect fill="#55595c" width="100%" height="100%"></rect><text fill="#eceeef" dy=".3em" x="50%" y="50%">Thumbnail</text></svg> -->
            <div class="card-body">
              <p class="card-text">Продолжение....</p>
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                    <input type="button" class="btn btn-sm btn-outline-secondary" value="Открыть в новом окне" onclick="window.open('9.jpg')">
                  <!-- <button type="button" class="btn btn-sm btn-outline-secondary">Edit</button> -->
                </div>
                <!-- <small class="text-muted">9 mins</small> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <section class="jumbotron text-center">
    <div class="container">
        <h1 class="jumbotron-heading">Сколько стоит кованое изделие?</h1>
        <br>
        <p class="lead text-muted"  align="justify">Едва ли кто-нибудь сразу скажет Вам стоимость изделия, которого ещё нет хотя бы в проекте. После долгих размышлений я решил пользоваться формулой: минимальная стоимость изделия (включая затраты на покупку металла) = (1000 + K * С) рублей; где 1000 - расходы на вспомогательные материалы и износ инструмента и оборудования, на доставку металла и краски; К - коэффициент стоимости, равный 3, если изделие нужно собрать сваркой, равный 4, если изделие нужно собрать сваркой и покрасить; С - стоимость металла, необходимого для изготовления кованого изделия. Доставка и монтаж учитываются отдельно. Можно добиться заметной экономии путём активного участия в изготовлении или упрощении конструкции.</p>      
        
        <br><!-- <p>
          <a href="#" class="btn btn-primary my-2">Main call to action</a>
          <a href="#" class="btn btn-secondary my-2">Secondary action</a>
        </p> -->
      </div>
    <div class="container">
      <h1 class="jumbotron-heading">Почему нет номера телефона?</h1>
      <br>
      <p class="lead text-muted"  align="justify">Метод проб и ошибок привёл меня выводу: разговор по телефону обычно оказывается беспредметным и яловым и всегда переходит либо в переписку, либо в диалог при встрече. Прежде, чем Вы свяжетесь со мной, подготовьте, пожалуйста, список Ваших требований к изделию, например: должно быть не дороже 20000 руб, обязательно размеры, нужно ли красить, нужно ли доставить, нужен ли монтаж (калитки или ворот, например) и другие важные детали, которые могут существенно повлиять на срок изготовления и стоимость. Если у Вас есть фотография или рисунок желаемого изделия, то лучше прислать его мне для подготовки эскиза и калькуляции. Чтобы открыть контакты, вернитесь в начало и кликните по кнопке вверху, справа.</p>      
      <!-- <p>
        <a href="#" class="btn btn-primary my-2">Main call to action</a>
        <a href="#" class="btn btn-secondary my-2">Secondary action</a>
      </p> -->
    </div>    
  </section>

</main>

<footer class="text-muted">
  <div class="container">
    <p class="float-right">
      <a href="#">Вернуться в начало</a>
    </p>
    <!-- <p>Album example is © Bootstrap, but please download and customize it for yourself!</p> -->
    <!-- <p>New to Bootstrap? <a href="https://getbootstrap.com/">Visit the homepage</a> or read our <a href="/docs/4.2/getting-started/introduction/">getting started guide</a>.</p> -->
  </div>
</footer>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
      <script>window.jQuery || document.write('<script src="/docs/4.2/assets/js/vendor/jquery-slim.min.js"><\/script>')</script><script src="/docs/4.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-zDnhMsjVZfS3hiP7oCBRmfjkQC4fzxVxFhBx8Hkz2aZX8gEvA/jsP3eXRCvzTofP" crossorigin="anonymous"></script>

<script type="text/javascript">var UXC_requirements = { status: false, text: "" };
var uxc_work = true;
var tester_role = null;

var clearUXContainer = function() {
    $(".uxc_info_text").hide();
    $(".UXC_Plugins").removeClass("rec");
    $(".uxc_question").html("");
    $(".uxc_panel_btn").html("");
};

const clearLocalStorage = () => {
    window.localStorage.removeItem("activeStep");
    window.localStorage.removeItem("uxc_text_rating");
    window.localStorage.removeItem("uxc_text_textarea");
    window.localStorage.removeItem("uxc_text_radio");
    window.localStorage.removeItem("uxc_text_checkbox");
};

function UXC_initialization() {
    chrome.runtime.sendMessage({ eventPage: "change_btn_next_state" });

    setBackground("openPopup");

    chrome.runtime.sendMessage(chrome.i18n.getMessage("@@extension_id"), { eventPage: "grabRequirements" }, function(response) {
        if (response && response.config && response.config.requirements) {
            if (document.querySelectorAll(".UXC_Plugins").length === 0) {
                $("body").append(tmpl("uxc_main_window_plugin", {}));
            }
            $(".UXC_Plugins").removeClass("rec");
            $(".uxc_question").html("");

            UXC_open_modal(response.config.requirements, "", chrome.i18n.getMessage("extContinue"), "uxc_btn_play uxc_green", "white_one");

            clearUXContainer();

            $(".uxc_btn_play").click(function() {
                console.log("rec");

                chrome.runtime.sendMessage({ eventPage: "update_config_status_rec" });

                if (document.getElementById("uxc_main_modal")) {
                    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                }
            });
        }
    });

    chrome.runtime.onMessage.addListener(function(request, sender, sendResponse) {

        // Костыль для "fxo.io"
        if (window.location.hostname === "fxo.io") {
            var interval = setInterval(function() {
                var frame = $('#fxo-messenger-iframe');
    
                if (frame) {
                    frame.parent().css('z-index', 1)
                    clearInterval(interval);
                }
            }, 100);
        }

        if (request.eventPage == "update") {
            renderPopup(request.config);

            if (uxc_work == false) {
                $(".uxc_close").click();
            }

            return;
        }

        if (request.eventPage == "audioStartError") {
            UXC_open_modal(
                chrome.i18n.getMessage("extRetryRecord"),
                function() {
                    forcedShutdown();
                },
                chrome.i18n.getMessage("extStartAgain"),
                "uxc_btn_play uxc_green"
            );

            $(".UXC_Plugins").remove();
            $("#uxc_main_modal.white");

            return;
        }

        if (request.eventPage == "pauseRec") {
            console.log(request);
            uxc_work = false;
            setBackground("pauseRec");
            renderPopup(request.config);

            return;
        }

        if (request.eventPage == "continueRec") {
            console.log(request);
            uxc_work = true;
            UXC_main_config.statusRec = "rec";
            renderPopup(request.config);

            return;
        }

        if (request.eventPage == "UXC_mic_progress") {
            $("#UXC_mic_progress").css({ height: request.progress + "%" });

            return;
        }

        if (request.eventPage == "UXC_mic_fail") {
            $("#micro_block_error").text(chrome.i18n.getMessage("extMicFail"));

            return;
        }

        if (request.eventPage == "UXC_mic_fixed") {
            $("#micro_block_error").text("");

            return;
        }

        if (request.eventPage == "microNotOKinTest") {
            UXC_open_modal(
                chrome.i18n.getMessage("extMicNotOk"),
                function() {
                    forcedShutdown();
                },
                chrome.i18n.getMessage("extStartAgain"),
                "uxc_btn_play uxc_green"
            );

            $(".UXC_Plugins").remove();

            return;
        }

        if (request.eventPage == "progress") {
            $(".uxc_text_modal").text(chrome.i18n.getMessage("extLoading"));
            $("#uxc_progress_wrap").removeAttr("style");
            $("#uxc_progress").width(request.progress + "%");
            $("#_uxcrowd_send_btn").hide();
            $("#_uxcrowd_send_btn_fail").hide();

            return;
        }

        if (request.eventPage == "show_info") {
            tester_role = request.tester_role;
            UXC_next(2);

            return;
        }

        if (request.eventPage == "show_select_window") {
            UXC_open_modal(
                chrome.i18n.getMessage("extSelectScreen"),
                [
                    {
                        text_btn: chrome.i18n.getMessage("extSelectAgain"),
                        class_btn: "uxc_green",
                        function_btn: function() {
                            selectTab();
                        }
                    },
                    {
                        text_btn: chrome.i18n.getMessage("extStopRecord"),
                        class_btn: "uxc_ml_15",
                        function_btn: function() {
                            forcedShutdown();
                        }
                    }
                ],
                "",
                "",
                "two_btn"
            );

            return;
        }

        if (request.eventPage == "requirements") {
            UXC_requirements.status = true;
            UXC_requirements.text = request.requirements;
            UXC_next(2);

            return;
        }

        if (request.eventPage == "no_requirements") {
            UXC_requirements.status = false;
            UXC_next(2);

            return;
        }

        if (request.eventPage == "finalModal") {
            UXC_next(3);

            return;
        }

        if (request.eventPage == "hideSpinner") {
            $("#uxc_instruction_block").html(chrome.i18n.getMessage("extSelectWindowTooltip"));

            return;
        }

        if (request.eventPage == "reloadPageRec") {
            UXC_requirements.status = false;
            location.reload();

            return;
        }

        if (request.eventPage == "closeRecTab") {
            UXC_open_modal(
                chrome.i18n.getMessage("extClosedTestingPage"),
                [
                    {
                        text_btn: chrome.i18n.getMessage("extContinueTest"),
                        class_btn: "uxc_green",
                        function_btn: function() {
                            openCloseTab();
                        }
                    },
                    {
                        text_btn: chrome.i18n.getMessage("extContinueTest"),
                        class_btn: "uxc_green",
                        function_btn: function() {
                            recCloseTab();
                        }
                    },
                    {
                        text_btn: chrome.i18n.getMessage("extStopRecord"),
                        class_btn: "uxc_ml_15",
                        function_btn: function() {
                            forcedShutdown();
                        }
                    }
                ],
                chrome.i18n.getMessage("extCancel"),
                "uxc_green",
                "three_btn"
            );

            return;
        }

        if (request.eventPage == "update_first") {
            if (request.config.statusRec != "audioStartError") {
                if ($("#uxc_main_modal").length == 1) {
                    return;
                }

                UXC_open_modal(request.config.requirements, "", chrome.i18n.getMessage("extContinue"), "uxc_btn_play uxc_green", "white_one");

                clearUXContainer();

                $(".uxc_btn_play").click(function() {
                    console.log("rec");

                    chrome.runtime.sendMessage({ eventPage: "update_config_status_rec" });

                    if (document.getElementById("uxc_main_modal")) {
                        document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                    }
                });
            }

            return;
        }

        if (request.eventPage == "closeAfterTab") {
            UXC_open_modal(
                chrome.i18n.getMessage("extClosedAllPages"),
                function() {
                    chrome.runtime.sendMessage({ eventPage: "openCloseTab" });
                    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                },
                chrome.i18n.getMessage("extOpenAgain"),
                "uxc_green",
                ""
            );

            return;
        }

        if (request.eventPage == "endRec") {
            var congrat_text = chrome.i18n.getMessage("extThanksForVideo");

            if (request.config.tester_role === "ROLE_SIDE_TESTER") {
                congrat_text = chrome.i18n.getMessage("extThanksGoodWork");
                UXC_open_modal(congrat_text, null, "", "", "no_btn");

                $(".uxc_close_modal").hide();

                window.onbeforeunload = null;
                chrome.runtime.sendMessage({ eventPage: "reloadApp" });

                if(request.config.redirectUrl !== undefined) {
                    window.open(request.config.redirectUrl);
                }
            } else {
                UXC_open_modal(
                    congrat_text,
                    function() {
                        window.onbeforeunload = null;
                        chrome.runtime.sendMessage({ eventPage: "reloadApp" });
                        location.reload();
                    },
                    "OK",
                    "uxc_green"
                );
            }

            return;
        }

        if (request.eventPage == "sendFail") {
            $("#uxc_progress_wrap").hide();
            $(".UXC_Plugins").remove();

            UXC_open_modal(request.text, function() {}, chrome.i18n.getMessage("extSendAgain"), "uxc_green", "sendFail");

            return;
        }

        if (request.firstStart == true) {
            UXC_open_modal(
                chrome.i18n.getMessage("extOkNowActivate"),
                function() {
                    chrome.runtime.sendMessage({ eventPage: "firstStart" });
                    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                },
                chrome.i18n.getMessage("extOkNext"),
                "uxc_green",
                "",
                "reloadAppFirst"
            );

            return;
        }

        if (request.firstEnd == true) {
            UXC_open_modal(
                chrome.i18n.getMessage("extThanksActivated"),
                function() {
                    chrome.runtime.sendMessage({ eventPage: "firstEnd" });
                    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                    location.reload();
                },
                chrome.i18n.getMessage("extGoToTest"),
                "uxc_green",
                "",
                "reloadApp"
            );

            return;
        }

        if (request.eventPage == "openBeforeFinalModal") {
            UXC_open_modal(chrome.i18n.getMessage("extVideoRecorded"), "no_btn");

            return;
        }

        if (request.statusRecEl == "false") {
            UXC_open_modal(
                chrome.i18n.getMessage("extSorryTestNotAvailable"),
                function() {
                    chrome.runtime.sendMessage({ eventPage: "reloadApp" });
                    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                    location.reload();
                },
                chrome.i18n.getMessage("extClose"),
                ""
            );

            return;
        }

        if (request.eventPage == "openFinalModal") {
            var text = chrome.i18n.getMessage("extVideoSaved");

            console.log("uxc_work");

            uxc_work = false;

            if (tester_role == "ROLE_SIDE_TESTER") {
                text = chrome.i18n.getMessage("extTestReady");
            }

            UXC_open_modal(text, function() {}, chrome.i18n.getMessage("extSend"), "uxc_green", "finished");

            return;
        }
        // предупреждение после попытки закрыть главную вкладку ("Прервать тестирование?")
        if (request.eventPage == "interrupt") {
            UXC_open_modal(
                chrome.i18n.getMessage("interrupt_text"),
                [
                    {
                        text_btn: chrome.i18n.getMessage("extContinue"),
                        class_btn: "uxc_green",
                        function_btn: function() {
                            chrome.runtime.sendMessage({ eventPage: "continue_after_interrupt" });
                            location.reload();
                        }
                    },
                    {
                        text_btn: chrome.i18n.getMessage("extStopRecord"),
                        class_btn: "uxc_ml_15",
                        function_btn: function() {
                            forcedShutdown();
                        }
                    }
                ],
                "",
                "",
                "two_btn"
            );

            return;
        }

        //Ошибка сервера
        if (request.eventPage == "error") {
            if (window.location.origin !== UXC_main_config.url) {
                var error_text = chrome.i18n.getMessage("extPleaseAuth");
                UXC_open_modal(error_text, null, "", "", "no_btn");
            } else {
                var error_text = chrome.i18n.getMessage("serverError");
                UXC_open_modal(error_text, null, "", "", "no_btn");
            }
            return;
        }

        return true;
    });
}

function openCloseTab() {
    chrome.runtime.sendMessage({ eventPage: "openCloseTab" });
    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
}

function reloadApp() {
    chrome.runtime.sendMessage({ eventPage: "reloadApp" });
    location.reload();
}

function forcedShutdown() {
    clearLocalStorage();

    chrome.runtime.sendMessage({ eventPage: "forcedShutdown" });

    location.reload();
}

function recCloseTab() {
    chrome.runtime.sendMessage({ eventPage: "recCloseTab" });
    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
}

function selectTab() {
    chrome.runtime.sendMessage({ eventPage: "selectTab" });
    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
}

function updateStatusMic() {
    document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
    location.reload();
}

function UXC_next(num) {
    switch (num) {
        case 1:
            var text;

            if (tester_role == "ROLE_SIDE_TESTER") {
                text = chrome.i18n.getMessage("extMessage001");
            } else {
                text = chrome.i18n.getMessage("extIntruductionText");
            }

            UXC_open_modal(
                text,
                function() {
                    UXC_next(2);
                },
                chrome.i18n.getMessage("extMessage002"),
                "uxc_green"
            );

            break;

        case 2:
            var text = chrome.i18n.getMessage("extMessage003");

            UXC_open_modal(text, "", chrome.i18n.getMessage("extConfirm"), "uxc_btn_play uxc_green");

            $(".uxc_btn_play").click(function() {
                $(this).hide();
                $("#uxc_text_for_instruction").hide();

                if (navigator.appVersion.includes("Mac OS")) {
                    $(".uxc_text_modal").html(chrome.i18n.getMessage("extMessage003Mac"));
                } else {
                    $(".uxc_text_modal").append(chrome.i18n.getMessage("extMessage004"));
                }

                chrome.runtime.sendMessage({ eventPage: "startRec" });
            });

            break;

        case 3:
            var text = chrome.i18n.getMessage("extMessage005");

            UXC_open_modal(text, "", chrome.i18n.getMessage("extLetsGo"), "uxc_btn_play uxc_green");

            $(".uxc_btn_play").click(function() {
                chrome.runtime.sendMessage({ eventPage: "secondStart" });
                $(".uxc_content_modal").hide();
            });

            break;

        case 4:
            UXC_open_modal(UXC_requirements.text, "", chrome.i18n.getMessage("extMessage006"), "uxc_btn_play uxc_green");

            $(".uxc_btn_play").click(function() {
                document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
                chrome.runtime.sendMessage({ eventPage: "startRec" });
            });

            break;
    }
}

var UXC_open_modal = (window.UXC_open_modal = function UXC_open_modal(text, func, text_btn, uxc_class, type, api, objThree) {
    if (document.getElementById("uxc_main_modal")) {
        document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
    }

    if (type == "sendFail") {
        var uxc_element = document.createElement("div");

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_video_send_fail", {
            text: text,
            _uxcrowd_send_btn_fail: chrome.i18n.getMessage("_uxcrowd_send_btn_fail")
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);
        document.getElementById("_uxcrowd_send_btn_fail").addEventListener("click", function() {
            $("#uxc_progress_wrap").removeAttr("style");
            chrome.runtime.sendMessage({ eventPage: "autoAndSaveAndSendVideo" }, function(obj) {});
        });
        addCloseBtn(api);

        return;
    }

    if (type == "finished") {
        var uxc_element = document.createElement("div");

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_video_send", {
            text: text,
            _uxcrowd_send_btn: chrome.i18n.getMessage("_uxcrowd_send_btn")
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);
        document.getElementById("_uxcrowd_send_btn").addEventListener("click", function() {
            $("#uxc_progress_wrap").removeAttr("style");
            chrome.runtime.sendMessage({ eventPage: "saveAndSendVideo" }, function(obj) {});
        });
        addCloseBtn(api);

        return;
    }

    if (type == "white_one") {
        var uxc_element = document.createElement("div");
        var uxc_html_element = tmpl("UXC_tmpl_modal_white", {
            text: text,
            textBtn: text_btn,
            introduction: chrome.i18n.getMessage("introduction"),
            uxc_class: uxc_class
        });

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = uxc_html_element;

        if ($("#uxc_main_modal").length == 1) {
            return;
        }

        document.getElementsByTagName("html")[0].appendChild(uxc_element);
        $("#uxc_main_modal").addClass("white");

        uxc_element.getElementsByClassName("uxc_btn_modal")[0].addEventListener("click", function() {
            $("#uxc_main_modal").removeClass("white");
            document.getElementsByTagName("html")[0].removeChild(document.getElementById("uxc_main_modal"));
            chrome.runtime.sendMessage({ eventPage: "update_config" });
        });
        addCloseBtn(api);

        return;
    }

    if (type == "info_modal") {
        var obj_modal = func[0];
        var all_element_info = '<div class="' + obj_modal.mainClass + '">';
        var arrayBtn = obj_modal.buttons;
        var uxc_element = document.createElement("div");

        for (var obj_element_info in obj_modal.info) {
            console.log(obj_element_info);

            all_element_info +=
                '<div class="obj_element_info">' +
                '<div class="obj_element_info_img ' +
                obj_modal.info[obj_element_info].class +
                '" style="background:' +
                obj_modal.info[obj_element_info].img +
                '"></div>' +
                '<div class="obj_element_info_text" style="margin-bottom:' +
                obj_modal.info[obj_element_info].mb +
                '">' +
                obj_modal.info[obj_element_info].text +
                "</div>" +
                "</div>";
        }

        all_element_info += "</div>";
        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_modal_custom", {
            all_element_info: all_element_info,
            uxc_class_btn_one: arrayBtn[0].class_btn,
            text_one_btn: arrayBtn[0].text_btn,
            uxc_class_btn_two: arrayBtn[1].class_btn,
            text_two_btn: arrayBtn[1].text_btn
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);
        document.getElementsByTagName("html")[0].appendChild(uxc_element);

        document.getElementById("_uxc_one_btn").addEventListener("click", function() {
            obj_modal.buttons[0].function_btn();
        });
        document.getElementById("_uxc_two_btn").addEventListener("click", function() {
            obj_modal.buttons[1].function_btn();
        });

        addCloseBtn(api);

        return;
    }

    if (type == "three_btn") {
        var arrayBtn = func;
        var uxc_element = document.createElement("div");

        console.log("arrayBtn", arrayBtn);

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_modal_three", {
            text: text,
            uxc_class_btn_one: arrayBtn[0].class_btn,
            text_one_btn: arrayBtn[0].text_btn,
            uxc_class_btn_two: arrayBtn[1].class_btn,
            text_two_btn: arrayBtn[1].text_btn,
            uxc_class_btn_three: arrayBtn[2].class_btn,
            text_three_btn: arrayBtn[2].text_btn
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);

        document.getElementById("_uxc_one_btn").addEventListener("click", function() {
            arrayBtn[0].function_btn();
        });
        document.getElementById("_uxc_two_btn").addEventListener("click", function() {
            arrayBtn[1].function_btn();
        });
        document.getElementById("_uxc_three_btn").addEventListener("click", function() {
            arrayBtn[2].function_btn();
        });

        addCloseBtn(api);

        return;
    }

    if (type == "two_btn") {
        var arrayBtn = func;
        var uxc_element = document.createElement("div");

        console.log("arrayBtn", arrayBtn);

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_modal_two", {
            text: text,
            uxc_class_btn_one: arrayBtn[0].class_btn,
            text_one_btn: arrayBtn[0].text_btn,
            uxc_class_btn_two: arrayBtn[1].class_btn,
            text_two_btn: arrayBtn[1].text_btn
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);

        document.getElementById("_uxc_one_btn").addEventListener("click", function() {
            arrayBtn[0].function_btn();
        });
        document.getElementById("_uxc_two_btn").addEventListener("click", function() {
            arrayBtn[1].function_btn();
        });

        addCloseBtn(api);

        return;
    }

    if (type == "no_btn") {
        var uxc_element = document.createElement("div");

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_modal_no_btn", {
            text: text
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);
        addCloseBtn(api);
    } else {
        var uxc_element = document.createElement("div");

        uxc_element.id = "uxc_main_modal";
        uxc_element.innerHTML = tmpl("UXC_tmpl_modal", {
            text: text,
            funcModal: func,
            textBtn: text_btn,
            uxc_class: uxc_class
        });

        document.getElementsByTagName("html")[0].appendChild(uxc_element);

        uxc_element.getElementsByClassName("uxc_btn_modal")[0].addEventListener("click", function() {
            if (func != "") {
                func();
            }
        });

        addCloseBtn(api);
    }
});

function addCloseBtn(api) {
    if ($(".uxc_close_modal").length <= 0) {
        $("#uxc_main_modal").append('<div class="uxc_close_modal"></div>');

        $(".uxc_close_modal").click(function() {
            if (api) {
                chrome.runtime.sendMessage({ eventPage: api });
                location.reload();
            } else {
                forcedShutdown();
            }
        });
    }
}

//Шаблонизатор http://javascript.ru/unsorted/templating 03.08.16
(function() {
    var cache = {};
    this.tmpl = function tmpl(str, data) {
        var fn = !/\W/.test(str)
            ? (cache[str] = cache[str] || tmpl(document.getElementById(str).innerHTML))
            : new Function(
                  "obj",
                  "var p=[],print=function(){p.push.apply(p,arguments);};" +
                      "with(obj){p.push('" +
                      str
                          .replace(/[\r\t\n]/g, " ")
                          .split("<%")
                          .join("\t")
                          .replace(/((^|%>)[^\t]*)'/g, "$1\r")
                          .replace(/\t=(.*?)%>/g, "',$1,'")
                          .split("\t")
                          .join("');")
                          .split("%>")
                          .join("p.push('")
                          .split("\r")
                          .join("\\'") +
                      "');}return p.join('');"
              );
        return data ? fn(data) : fn;
    };
})();

function renderPopup(config) {
    var clearQuestionContainer = function() {
        $(".UXC_Plugins").removeClass("rec");
        $(".uxc_question").html("");
    };

    if (document.querySelectorAll(".UXC_Plugins").length === 0) {
        console.log(">>>>>>> Before adding:");
        console.log("script didn't find the popup");
        console.log(document.querySelectorAll(".UXC_Plugins"));
        $("body").append(tmpl("uxc_main_window_plugin", {}));
        clearQuestionContainer();
        console.log(">>>>>>> After adding:");
        console.log(document.querySelectorAll(".UXC_Plugins"));
    }
    // console.log(config);

    // console.log(chrome.i18n.getMessage("extMessage008"), config);

    switch (config.statusRec) {
        case "audioStartError":
            UXC_open_modal(
                chrome.i18n.getMessage("extMessage007"),
                function() {
                    forcedShutdown();
                },
                chrome.i18n.getMessage("extMessage009"),
                "uxc_btn_play uxc_green"
            );

            $(".UXC_Plugins").remove();
            $("#uxc_main_modal.white");

            break;

        case "rec":
            var button, event;
            var class_next_step = "";
            var uxc_timer = 5 - (Math.floor(new Date().getTime() / 1000) - config.time_click_next);

            if (uxc_timer > 0) {
                class_next_step = "disabled";

                console.log(uxc_timer);

                setTimeout(function() {
                    console.log("");

                    if (localStorage.getItem("uxc_update_time") == "true") {
                        localStorage.setItem("uxc_update_time", "false");

                        console.log("update");

                        chrome.runtime.sendMessage({ eventPage: "update_config" });
                    }
                }, uxc_timer * 1000);
            } else {
                class_next_step = "active";
            }
            if (uxc_work || !config.on_pause) {
                $(".UXC_Plugins").addClass("rec");

                if (config.mainPageSteps.length == config.activeStep) {
                    $(".uxc_panel_btn").html(
                        tmpl("UXC_tmpl_btn_pause_stop", {
                            extPause: chrome.i18n.getMessage("extPause"),
                            extBtnFinish: chrome.i18n.getMessage("extBtnFinish"),
                            class_next_step: class_next_step
                        })
                    );

                    button = $(".uxc_btn_stop");
                    localStorage.setItem("uxc_update_time", "true");
                    event = "stopRec";
                } else {
                    $(".uxc_panel_btn").html(
                        tmpl("UXC_tmpl_btn_pause_next", {
                            extBtnNext: chrome.i18n.getMessage("extBtnNext"),
                            extPause: chrome.i18n.getMessage("extPause"),
                            class_next_step: class_next_step
                        })
                    );

                    button = $(".uxc_item_next");
                    localStorage.setItem("uxc_update_time", "true");
                    event = "nextStep";
                }

                console.log(chrome.i18n.getMessage("extTaskNumber"));

                $(".uxc_question").html(
                    $.parseHTML(
                        tmpl("uxc_all_question", {
                            extTaskNumber: chrome.i18n.getMessage("extTaskNumber"),
                            all_questions: config.mainPageSteps[config.activeStep - 1],
                            activeStep: config.activeStep,
                            allStep: config.mainPageSteps.length
                        })
                    )
                );
            }

            $(".uxc_close").click(function() {
                uxc_work = false;

                $(".container_mic").hide();
                $(".uxc_question").html(chrome.i18n.getMessage("extMessage010"));
                $(".uxc_panel_btn").html(
                    tmpl("UXC_tmpl_forcedShutdown", {
                        extBtnYes: chrome.i18n.getMessage("extBtnYes"),
                        extBtnNo: chrome.i18n.getMessage("extBtnNo")
                    })
                );

                $(".UXC_tmpl_forcedShutdown_yes").click(function() {
                    setBackgroundNotConfig("breakTest");

                    clearLocalStorage();
                });

                $(".UXC_tmpl_forcedShutdown_no").click(function() {
                    uxc_work = true;
                    setBackground("openPopup");
                    $(".container_mic").show();
                });
            });

            var obj_question = config.mainPageSteps[config.activeStep - 1];

            switch (obj_question.stepType) {
                case "TEXT":
                    $(button).unbind();

                    $(button).click(function() {
                        if (!$(this).hasClass("disabled")) {
                            setBackground(event);
                        }
                    });

                    break;
                case "RATING":
                    $(button).unbind();

                    $(button).click(function() {
                        value = $("input:radio[name ='uxc_item_rating_radio_group']:checked").val();

                        if (!value || value <= 0) {
                            $("#block_error").text(chrome.i18n.getMessage("extMessage011"));
                        } else {
                            $("#block_error").text("");
                            if (!$(this).hasClass("disabled")) {
                                setBackground(event, value);
                            }
                        }
                    });

                    $(".uxc_rating_btn_custom").click(function() {
                        var value_radio = $(this)
                            .children("input")
                            .val();

                        localStorage.setItem("activeStep", config.activeStep);
                        localStorage.setItem("uxc_text_rating", value_radio);

                        $(".uxc_rating_btn_custom.active").removeClass("active");
                        $(this).addClass("active");
                        $(this)
                            .children("input")
                            .prop("checked", true);

                        for (var i = 0; i < value_radio; i++) {
                            $(".uxc_rating_btn_custom:eq(" + i + ")").addClass("active");
                        }
                    });

                    if (localStorage.getItem("activeStep") == config.activeStep) {
                        if (localStorage.getItem("uxc_text_rating")) {
                            console.log(Number(localStorage.getItem("uxc_text_rating")));

                            $("input:radio[name ='uxc_item_rating_radio_group']:eq(" + (Number(localStorage.getItem("uxc_text_rating")) - 1) + ")").prop("checked", true);

                            for (var i = 0; i < Number(localStorage.getItem("uxc_text_rating")); i++) {
                                $(".uxc_rating_btn_custom:eq(" + i + ")").addClass("active");
                            }
                        }
                    }

                    break;
                case "ANSWER":
                    $("#uxc_item_answer_textarea").bind("keydown", function (e) {
                        e.stopPropagation();
                    });
                    $("#uxc_item_answer_textarea").bind("input propertychange", function() {
                        localStorage.setItem("activeStep", config.activeStep);
                        localStorage.setItem("uxc_text_textarea", $("#uxc_item_answer_textarea").val());
                    });

                    $(button).unbind();

                    $(button).click(function() {
                        value = $("#uxc_item_answer_textarea").val();
                        if (!$(this).hasClass("disabled")) {
                            if (!value || value.length == 0) {
                                $("#block_error").text(chrome.i18n.getMessage("extMessage012"));
                            } else {
                                $("#block_error").text("");
                                localStorage.setItem("uxc_text_textarea", "");
                                setBackground(event, value);
                            }
                        }
                    });

                    // Не перехватывать фокус на тестируемом сайте из элеметов INPUT и TEXTAREA
                    const focusEl = document.activeElement;

                    if (!focusEl || (focusEl && focusEl.tagName !== 'INPUT' && focusEl.tagName !== 'TEXTAREA')) {
                        $("#uxc_item_answer_textarea").focus();
                    }

                    //

                    if (localStorage.getItem("activeStep") == config.activeStep) {
                        if (localStorage.getItem("uxc_text_textarea")) {
                            $("#uxc_item_answer_textarea").val(localStorage.getItem("uxc_text_textarea"));
                        }
                    }

                    break;
                case "RADIO":
                    $(".uxc_rating_btn_custom_input").click(function() {
                        var num_radio = $(this)
                            .children("input")
                            .data("num-radio");

                        $(".uxc_rating_btn_custom_input.active").removeClass("active");
                        $(this).addClass("active");
                        $(this)
                            .children("input")
                            .prop("checked", true);

                        localStorage.setItem("activeStep", config.activeStep);
                        localStorage.setItem("uxc_text_radio", num_radio);
                    });

                    $(button).unbind();

                    $(button).click(function() {
                        value = $("input:radio[name ='uxc_item_radio_group']:checked").val();

                        if (!value) {
                            $("#block_error").text(chrome.i18n.getMessage("extMessage012"));
                        } else {
                            $("#block_error").text("");
                            if (!$(this).hasClass("disabled")) {
                                setBackground(event, value);
                            }
                        }
                    });

                    if (localStorage.getItem("activeStep") == config.activeStep) {
                        if (localStorage.getItem("uxc_text_radio")) {
                            var el = $("input:radio[data-num-radio =" + localStorage.getItem("uxc_text_radio") + "]");

                            $(el)
                                .parent("div")
                                .addClass("active");
                            $(el).prop("checked", true);
                        }
                    }

                    break;
                case "CHECKBOX":
                    $(".uxc_rating_btn_custom_input_checkbox").click(function() {
                        var array_checkbox = [];

                        if (
                            $(this)
                                .children("input")
                                .prop("checked")
                        ) {
                            $(this)
                                .children("input")
                                .prop("checked", false);

                            $(this).removeClass("active");
                        } else {
                            $(this)
                                .children("input")
                                .prop("checked", true);

                            $(this).addClass("active");
                        }

                        $(".uxc_rating_btn_custom_input_checkbox input:checked").each(function() {
                            array_checkbox.push($(this).data("num-checkbox"));
                        });

                        localStorage.setItem("activeStep", config.activeStep);
                        localStorage.setItem("uxc_text_checkbox", JSON.stringify(array_checkbox));

                        console.log(array_checkbox);
                    });

                    $(button).unbind();

                    $(button).click(function() {
                        value = $("input:checkbox[name ='uxc_item_checkbox']:checked")
                            .map(function() {
                                return $(this).val();
                            })
                            .get();

                        if (!value || value.length == 0) {
                            $("#block_error").text(chrome.i18n.getMessage("extMessage012"));
                        } else {
                            $("#block_error").text("");

                            if (!$(this).hasClass("disabled")) {
                                setBackground(event, value);
                            }
                        }
                    });

                    if (localStorage.getItem("activeStep") == config.activeStep) {
                        if (localStorage.getItem("uxc_text_checkbox")) {
                            var array_checkbox = JSON.parse(localStorage.getItem("uxc_text_checkbox"));

                            console.log(array_checkbox);

                            for (var i in array_checkbox) {
                                var el = $("input:checkbox[data-num-checkbox =" + array_checkbox[i] + "]");

                                $(el)
                                    .parent("div")
                                    .addClass("active");
                                $(el).prop("checked", true);
                            }
                        }
                    }

                    break;
            }

            $(".uxc_item_pause").click(function() {
                console.log("clicked pause");
                uxc_work = false;
                setBackground("pauseRec");
            });

            break;
        case "pause":
            clearQuestionContainer();

            $(".uxc_panel_btn").html(
                tmpl("UXC_tmpl_btn_resume", {
                    extBtnContinue: chrome.i18n.getMessage("extBtnContinue")
                })
            );

            $(".uxc_item_resume").click(function() {
                uxc_work = true;
                setBackground("resumeRec");
            });

            break;
        case "selectDesktop":
            //clearQuestionContainer();
            $(".UXC_Plugins").remove();
            $(".uxc_panel_btn").html(
                tmpl("UXC_tmpl_select_desktop", {
                    extRequest: chrome.i18n.getMessage("extRequest")
                })
            );

            $(".uxc_close").click(function() {
                setBackgroundNotConfig("forcedShutdown");
            });

            break;
    }



    UXC_position(config);
}

function UXC_position(_config) {
    var UXC_block = document.getElementsByClassName("UXC_Plugins")[0];
    var UXC_main_block = document.querySelector(".uxc_main_block");
    var UXC_resizing_block = document.getElementsByClassName("resizing_block")[0];

    var default_x, default_y;

    delta_x = 0;
    delta_y = 0;

    /* Ставим обработчики событий на нажатие и отпускание клавиши мыши */
    UXC_main_block.onmousedown = saveXY;
    //UXC_resizing_block.onmousedown = resizeXY;

    document.onmouseup = clearXY;

    _config.positionY && (UXC_block.style.top = _config.positionY + "px");
    _config.positionX && (UXC_block.style.left = _config.positionX + "px");

    /* При нажатии кнопки мыши попадаем в эту функцию */
    function saveXY(obj_event) {
        /* Получаем текущие координаты курсора */
        // if (obj_event) {
        //     x = obj_event.pageX;
        //     y = obj_event.pageY;
        // } else {
        //     x = window.event.clientX;
        //     y = window.event.clientY;
        // }
        /* Узнаём текущие координаты блока */
        x_block = UXC_block.offsetLeft;
        y_block = UXC_block.offsetTop;
        /* Узнаём смещение */
        delta_x = x_block - window.event.clientX;
        delta_y = y_block - window.event.clientY;
        /* При движении курсора устанавливаем вызов функции moveWindow */
        document.onmousemove = moveBlock;
    }

    function clearXY(_event) {
        document.onmousemove = null; // При отпускании мыши убираем обработку события движения мыши

        if (!_event.target.classList.contains("uxc_close")) {
            chrome.runtime.sendMessage({
                eventPage: "setPosition",
                params: { x: UXC_block.offsetLeft, y: UXC_block.offsetTop },
            });
        }
    }

    function moveBlock(obj_event) {
        /* Получаем новые координаты курсора мыши */
        // if (obj_event) {
        //     x = obj_event.pageX;
        //     y = obj_event.pageY;
        // } else {
        //     x = window.event.clientX;
        //     y = window.event.clientY;
        // }
        /* Вычисляем новые координаты блока */
        new_x = delta_x + window.event.clientX;
        new_y = delta_y + window.event.clientY;

        if (new_x < 0) {
            new_x = 1;
        }
        if (document.documentElement.clientWidth < new_x + UXC_block.offsetWidth) {
            new_x = document.documentElement.clientWidth - UXC_block.offsetWidth - 1;
        }
        if (new_y < 0) {
            new_y = 1;
        }
        if (document.documentElement.clientHeight < new_y + UXC_block.offsetHeight) {
            new_y = document.documentElement.clientHeight - UXC_block.offsetHeight - 1;
        }

        UXC_block.style.top = new_y + "px";
        UXC_block.style.left = new_x + "px";
    }

    function resizeXY(obj_event) {
        /* Получаем текущие координаты курсора */
        if (obj_event) {
            x = obj_event.pageX;
            y = obj_event.pageY;
        } else {
            x = window.event.clientX;
            y = window.event.clientY;
        }
        default_x = x;
        default_y = y;

        /* При движении курсора устанавливаем вызов функции moveWindow */
        document.onmousemove = moveBlockResize;
    }

    function moveBlockResize(obj_event) {
        /* Получаем новые координаты курсора мыши */
        if (obj_event) {
            x = obj_event.pageX;
            y = obj_event.pageY;
        } else {
            x = window.event.clientX;
            y = window.event.clientY;
        }

        $("#UXC_Plugins").width(default_x - x);
        $("#UXC_Plugins").height(default_y + y);
    }
}

//Отправка в DOM (injected_modal.js)
function setDom(code, tabId) {
    chrome.tabs.executeScript(tabId, { code: code });
}

//Отправка в Background.js
function setBackground(eventPage, answerValue) {
    if (eventPage == "stopRec") {
        uxc_work = true;
    }

    chrome.runtime.sendMessage({ eventPage: eventPage, answerValue: answerValue }, function(obj) {
        if (obj && obj.config) {
            renderPopup(obj.config);
        }

        return obj;
    });
}

function setBackgroundNotConfig(eventPage, answerValue) {
    chrome.runtime.sendMessage({ eventPage: eventPage, answerValue: answerValue }, function(obj) {});
}
</script></body>
</body>
</html>
